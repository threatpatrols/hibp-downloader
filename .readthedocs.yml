
version: 2

mkdocs:
  configuration: "docs/mkdocs.yml"

build:
  os: ubuntu-22.04
  tools:
    python: "3.10"
  jobs:
    pre_build:
      - pip install mkdocs-material==9.1.21  # https://pypi.org/project/mkdocs-material/#history
      - pip install pydoc-markdown==4.8.2    # https://pypi.org/project/pydoc-markdown/#history
      - pip install novella==0.2.6           # https://pypi.org/project/novella/#history
      - cd docs && novella --base-url /en/latest/
    post_build:
      - rm -Rf $READTHEDOCS_OUTPUT/html
      - mv docs/_site $READTHEDOCS_OUTPUT/html

# README: the post_build steps give effect to removing the content generated by the readthedocs build system
# whereby they do a "python -m mkdocs build ..."; there seems to be no way to stop that build step running so
# as a post_build action we remove and move our novella rendered content into place
